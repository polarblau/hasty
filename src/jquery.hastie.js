// Generated by CoffeeScript 1.3.1
(function() {
  var $;

  $ = jQuery;

  $.fn.hastie = function(options) {
    var defaultTemplate, interpolate, render, settings;
    settings = $.extend({});
    defaultTemplate = "<ul>\n  {{#comments}}\n    <li>{{body}}</li>\n  {{/comments}}\n</ul>";
    render = function(comments, $container) {
      var output;
      output = Mustache.render(defaultTemplate, {
        comments: comments
      });
      return $container.html(output);
    };
    interpolate = function(string, replacements) {
      var key, value, _results;
      _results = [];
      for (key in replacements) {
        value = replacements[key];
        _results.push(string.replace("{" + key + "}", value));
      }
      return _results;
    };
    return this.each(function() {
      var $this, commitIDs, url;
      $this = $(this);
      commitIDs = $this.data('commit-ids');
      url = interpolate($this.data('comments-url'), {
        sha: commentsIDs[0]
      });
      return $.ajax({
        url: url,
        success: function(comments) {
          return render(comments.data, $this);
        },
        dataType: 'jsonp'
      });
    });
  };

}).call(this);
